<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eco Challenges</title>
<link rel="stylesheet" href="/node_modules/alk-life/css/alk-life.min.css">
<style>
  
* { box-sizing:border-box; margin:0; padding:0; font-family: Arial, sans-serif; }
body { background:#f5f5f5; padding-bottom:80px;font-family: "ALK Life", sans-serif; }
.header { display:flex; flex-direction:column; align-items:flex-start; justify-content:center; text-align:left; padding:30px 20px 15px; background:#4CAF50; color:white; border-bottom-left-radius:20px; border-bottom-right-radius:20px; }
.header h1 { font-size:24px; font-weight:bold; }
.header .logout { margin-top:10px; padding:6px 12px; background:#388e3c; color:white; border:none; border-radius:6px; cursor:pointer; }
.suggestions { display:flex; justify-content:space-around; margin:20px; }
.suggestions img { width:50px; height:50px; }
.suggestions div { text-align:center; font-size:12px; margin-top:5px; }
.challenge-list { padding:0 20px; }
.challenge-card { position:relative; border-radius:15px; margin-bottom:15px; color:white; display:flex; justify-content:space-between; align-items:center; padding:15px; height:100px; background-size:cover; background-position:center; }
.challenge-card .points { background:yellow; color:black; padding:4px 10px; border-radius:20px; font-weight:bold; }
.challenge-card button { margin-left:10px; padding:4px 8px; border:none; border-radius:6px; background:#388e3c; color:white; cursor:pointer; }
.challenge-card button:hover { background:#2e7d32; }
.bottom-nav { position:fixed; bottom:0; left:0; right:0; height:70px; background:white; display:flex; justify-content:space-around; align-items:center; border-top:1px solid #ddd; z-index:100; }
.nav-item { text-align:center; font-size:12px; color:#777; text-decoration:none; }
.nav-item.active { color:#4CAF50; font-weight:bold; }
.nav-item img { width:24px; height:24px; display:block; margin:0 auto 5px; }
</style>
</head>
<body>

<div class="header">
  <h1>Find challenges</h1>
  <p id="welcomeMsg"></p>
  <button class="logout" id="logoutBtn">Logout</button>
</div>

<div class="suggestions">
  <div><img src="easy.png" alt=""><div>Easy</div></div>
  <div><img src="savings.png" alt=""><div>Savings</div></div>
  <div><img src="healthy.png" alt=""><div>Healthy</div></div>
  <div><img src="co2.png" alt=""><div>All</div></div>
</div>

<h2 style="margin:0 20px 10px;">Favorite challenges</h2>
<div class="challenge-list" id="challengeList">
  <!-- Dynamic challenge cards will go here -->
</div>

<div class="bottom-nav">
  <a class="nav-item" href="home.html"><img src="home.png" alt=""><br>Home</a>
  <a class="nav-item active"><img src="challenges.png" alt=""><br>Challenges</a>
  <a class="nav-item" href="profile.html"><img src="profile.png" alt=""><br>Profile</a>
  <a class="nav-item" href="company.html"><img src="chatbot.png" alt=""><br>Company</a>
</div>

<script>
let currentUser = JSON.parse(localStorage.getItem("currentUser"));
if(!currentUser){ window.location.href="index.html"; }
else { document.getElementById('welcomeMsg').textContent = `Hello, ${currentUser.username}!`; }

document.getElementById('logoutBtn').addEventListener('click', ()=>{
  localStorage.removeItem("currentUser");
  window.location.href="index.html";
});

// Challenges array (example)
const challenges = [
  { text: "I'm emptying my personal mailbox's recycle bin", points: 1, img: "challenge1.png" },
  { text: "I'm scanning my bin", points: 2, img: "challenge2.png" },
  { text: "I'm sticking a stop ad on my letterbox", points: 4, img: "challenge3.png" }
];

const challengeList = document.getElementById("challengeList");

challenges.forEach((ch, i)=>{
  const div = document.createElement("div");
  div.className = "challenge-card";
  div.style.backgroundImage = `url('${ch.img}')`;
  div.innerHTML = `
    <div>${ch.text}</div>
    <div>
      <span class="points">+${ch.points} ðŸ’Ž</span>
      <button id="btn${i}">Complete</button>
    </div>
  `;
  challengeList.appendChild(div);

  document.getElementById(`btn${i}`).addEventListener('click', ()=>{
    currentUser.points += ch.points;
    localStorage.setItem("currentUser", JSON.stringify(currentUser));
    let users = JSON.parse(localStorage.getItem("users") || '[]');
    const idx = users.findIndex(u=>u.username===currentUser.username);
    if(idx>=0){ users[idx].points = currentUser.points; localStorage.setItem("users", JSON.stringify(users)); }
    alert(`You earned ${ch.points} points! Total: ${currentUser.points}`);
  });
});
</script>

</body>
</html>
